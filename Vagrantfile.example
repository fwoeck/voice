host      = 'voice01'
domain    = 'wimdu.com'
fqdn      = "#{host}.#{domain}"
ipaddress = '33.33.33.100'

Vagrant.configure('2') do |config|

  config.vm.define host do |config|
  # config.vm.network             :forwarded_port, guest: 5900, host: 5900, auto_correct: true
    config.vm.network             :private_network, ip: ipaddress
    config.vm.box               = 'voice-base'
    config.vm.box_url           = 'http://dokmatic-cdn.s3.amazonaws.com/wimdu/voice-base.box'
    config.vm.hostname          = fqdn
    config.ssh.forward_agent    = true
  # config.ssh.private_key_path = '~/.ssh/id_rsa'
    config.omnibus.chef_version = :latest
  end

  config.vm.provider 'virtualbox' do |v|
    v.customize ['modifyvm', :id, '--memory', '4096', '--cpus', '4']
    v.customize ['modifyvm', :id, '--natdnshostresolver1', 'on']
    v.customize ['modifyvm', :id, '--natdnsproxy1', 'on']
    v.customize ['modifyvm', :id, '--ioapic', 'on']
  end

  config.vm.provision :chef_solo do |chef|
    chef.custom_config_path = 'Vagrantfile.chef'
    chef.cookbooks_path     = 'cookbooks'
    chef.roles_path         = 'roles'
    chef.node_name          =  host
    chef.log_level          = :info
    chef.add_role('desktop')

    chef.json = {
      'ahn' => {
        'ami_pass' => '<password>'
      },
      'aws' => {
        'gpg_pass'  => '<password>',
        'key_id'    => '<your-aws-key-id>',
        'secret'    => '<your-aws-secret>',
        's3_backup' => 's3-eu-west-1.amazonaws.com/<bucket-name>'
      },
      'crm_provider' => {
        'name'       => 'Zendesk',
        'user'       => '<your-email>',
        'pass'       => '<password>',
        'domain'     => '<zendesk-domain>',
        'api_url'    => 'https://<zendesk-domain>.zendesk.com/api/v2',
        'user_url'   => 'https://<zendesk-domain>.zendesk.com/agent/#/users/USERID/requested_tickets',
        'ticket_url' => 'https://<zendesk-domain>.zendesk.com/agent/#/tickets/TID'
      },
      'etc' => {
        'domain'          => '<your-domain-name>',
        'deployment_host' => '<your-deployment-host>',
        'ext_interface'   => 'eth0',
        'external_ip'     => ipaddress,
        'ip_blacklist'    => ['23.250.10.130', '37.8.0.0/16', '37.59.0.0/16', '37.75.0.0/16', '37.187.0.0/16'],
        'ip_whitelist'    => []
      },
      'mysql' => {
        'wim_pass'  => '<password>',
        'root_pass' => '<password>'
      },
      'postfix' => {
        'mail_domain'  => '<your-mail-domain>',
        'local_admin'  => 'local@email.com',
        'remote_admin' => 'remote@email.com'
      },
      'rabbitmq' => {
        'pass' => '<password>'
      },
      'sipgate' => {
        'activate'   => false,
        'pass'       => '<password>',
        'trunk'      => '1111111t0',
        'number'     => '1111111111',
        'sms' => {
          'apihost'  => 'api.sipgate.net',
          'password' => '<password>',
          'user'     => '<your-sms-user>'
        },
        'proxy'      => 'sipconnect.sipgate.de'
      },
      'skype' => {
        'activate' => false,
        'pass'     => '<password>',
        'trunk'    => '11111111111111',
        'proxy'    => 'sip.skype.com'
      },
      'smtp' => {
        'address'  => 'email-smtp.eu-west-1.amazonaws.com',
        'port'     => '25',
        'username' => '<your-smtp-user>',
        'password' => '<password>'
      },
      'vagrant' => {
        'gateway'    => '33.33.33.1',
        'local_net'  => '192.168.50.0',
        'local_mask' => '255.255.255.0'
      },
      'vnc' => {
        'password' => '<password>'
      },
      'voice_rails' => {
        'keybase'    => '<password>',
        'admin' => {
          'email'    => 'admin@email.com',
          'fullname' => 'Your Name',
          'password' => 'P4ssw0rd',
          'secret'   => '0000',
          'name'     => '999'
        }
      },
      'wim' => {
        'gitbase' => 'git://github.com/fwoeck' # Set to git@github.com:<gh-user> for forks
      },
      'git' => {
        'user' => {
          'name'  => '<Your Name>',
          'email' => '<your-git-email>'
        },
        'github' => {
          'user'  => '<your-github-user>',
          'token' => '<password>'
        }
      }
    }
  end
end
